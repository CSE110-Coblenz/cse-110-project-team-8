{
  "name": "Level 4: Challenge",
  "description": "Put your Vim skills to the test! No instructions, just fix the code.",
  "keyframes": [
    {
      "tMs": 0,
      "state": [
        "private handleKeyPress = (event: KeyboardEvent) => {",
        "    if (event.key === \"F9\" && this.gameInitialized) {",
        "        event.preventDefault();",
        "        this.togglePause();",
        "        return;",
        "    }",
        "",
        "    if (this.isInBuffer || this.gamePaused) {",
        "        event.preventDefault();",
        "        return;",
        "    }",
        "",
        "    if (!this.controller || !this.leftView || !this.leftGrid) return;",
        "",
        "    event.preventDefault();",
        "",
        "    this.controller.handleInput(event);",
        "    this.markMismatches();",
        "",
        "    this.leftView.update(this.leftGrid);",
        "    this.gameView?.updateModeLabel();",
        "    const cursor = this.leftGrid.getCursor();",
        "    this.leftView.setCursor(cursor.row, cursor.col);",
        "};"
      ]
    },
    {
      "tMs": 90000,
      "state": [
        "private handleKeyPress = (e: KeyboardEvent) => {",
        "    if (e.key === \"F9\" && this.gameInitialized) {",
        "        e.preventDefault();",
        "        this.togglePause();",
        "        return;",
        "    }",
        "",
        "    if (this.isInBuffer || this.gamePaused) {",
        "        e.preventDefault();",
        "        return;",
        "    }",
        "",
        "    if (!this.controller || !this.leftView || !this.leftGrid) return;",
        "",
        "    e.preventDefault();",
        "",
        "    this.controller.handleInput(e);",
        "    this.markMismatches();",
        "",
        "    this.leftView.update(this.leftGrid);",
        "    this.gameView?.updateModeLabel();",
        "    const cur = this.leftGrid.getCursor();",
        "    this.leftView.setCursor(cur.row, cur.col);",
        "};"
      ]
    },
    {
      "tMs": 90000,
      "state": [
        "private handleKeyPress = (ev: KeyboardEvent) => {",
        "    if (ev.key === \"F9\" && this.gameInitialized) {",
        "        ev.preventDefault(); this.togglePause();",
        "        return;",
        "    }",
        "",
        "    if (this.isInBuffer || this.gamePaused) { ev.preventDefault(); return; }",
        "",
        "    if (!this.controller || !this.leftView || !this.leftGrid) { return; }",
        "",
        "    ev.preventDefault();",
        "",
        "    this.controller.handleInput(ev); this.markMismatches();",
        "",
        "    this.leftView.update(this.leftGrid); this.gameView?.updateModeLabel();",
        "    const c = this.leftGrid.getCursor();",
        "    this.leftView.setCursor(c.row, c.col);",
        "};"
      ]
    },
    {
      "tMs": 90000,
      "state": [
        "private handleKeyPress = (event: KeyboardEvent) => {",
        "    if (event.key === 'F9' && this.gameInitialized) {",
        "        event.preventDefault();",
        "        this.togglePause(); return;",
        "    }",
        "",
        "    if (this.gamePaused || this.isInBuffer) { event.preventDefault(); return; }",
        "",
        "    if (!this.leftGrid || !this.leftView || !this.controller) { return; }",
        "",
        "    event.preventDefault();",
        "",
        "    this.controller.handleInput(event); this.markMismatches();",
        "",
        "    this.leftView.update(this.leftGrid);",
        "    this.gameView?.updateModeLabel();",
        "    const p = this.leftGrid.getCursor();",
        "    this.leftView.setCursor(p.row, p.col);",
        "};"
      ]
    },
    {
      "tMs": 90000,
      "state": [
        "private handleKeyPress = (e: KeyboardEvent) => {",
        "    if (e.key === 'F9' && this.gameInitialized) { e.preventDefault(); this.togglePause(); return; }",
        "",
        "    if (this.gamePaused || this.isInBuffer) { e.preventDefault(); return; }",
        "",
        "    if (!this.controller || !this.leftGrid || !this.leftView) return;",
        "",
        "    e.preventDefault();",
        "",
        "    this.controller.handleInput(e);",
        "    this.markMismatches();",
        "    this.leftView.update(this.leftGrid); this.gameView?.updateModeLabel();",
        "",
        "    const cur = this.leftGrid.getCursor(); this.leftView.setCursor(cur.row, cur.col);",
        "};"
      ]
    },
    {
      "tMs": 90000,
      "state": [
        "private handleKeyPress = (evt: KeyboardEvent) => {",
        "    if (evt.key === 'F9' && this.gameInitialized) {",
        "        evt.preventDefault(); this.togglePause(); return;",
        "    }",
        "",
        "    if (this.gamePaused || this.isInBuffer) { evt.preventDefault(); return; }",
        "",
        "    if (!this.leftView || !this.controller || !this.leftGrid) return;",
        "",
        "    evt.preventDefault();",
        "",
        "    this.controller.handleInput(evt); this.markMismatches();",
        "",
        "    this.leftView.update(this.leftGrid);",
        "    this.gameView?.updateModeLabel();",
        "    const xy = this.leftGrid.getCursor();",
        "    this.leftView.setCursor(xy.row, xy.col);",
        "};"
      ]
    },
    {
      "tMs": 30000,
      "state": [
        "private handleKeyPress = (ev: KeyboardEvent) => {",
        "    if (ev.key === 'F9' && this.gameInitialized) { ev.preventDefault(); this.togglePause(); return; }",
        "",
        "    if (this.isInBuffer || this.gamePaused) { ev.preventDefault(); return; }",
        "",
        "    if (!this.leftView || !this.leftGrid || !this.controller) return;",
        "",
        "    ev.preventDefault();",
        "",
        "    this.controller.handleInput(ev); this.markMismatches();",
        "    this.leftView.update(this.leftGrid);",
        "",
        "    this.gameView?.updateModeLabel();",
        "    const pos = this.leftGrid.getCursor();",
        "    this.leftView.setCursor(pos.row, pos.col);",
        "};"
      ]
    },
    {
      "tMs": 90000,
      "state": [
        "private handleKeyPress = (k: KeyboardEvent) => {",
        "    if (k.key === 'F9' && this.gameInitialized) { k.preventDefault(); this.togglePause(); return; }",
        "",
        "    if (this.isInBuffer || this.gamePaused) { k.preventDefault(); return; }",
        "",
        "    if (!(this.controller && this.leftView && this.leftGrid)) return;",
        "",
        "    k.preventDefault();",
        "",
        "    this.controller.handleInput(k);",
        "    this.markMismatches();",
        "    this.leftView.update(this.leftGrid);",
        "",
        "    this.gameView?.updateModeLabel();",
        "    const c = this.leftGrid.getCursor(); this.leftView.setCursor(c.row, c.col);",
        "};"
      ]
    },
    {
      "tMs": 90000,
      "state": [
        "private handleKeyPress = (ev: KeyboardEvent) => {",
        "    if (ev.key === 'F9' && this.gameInitialized) { ev.preventDefault(); this.togglePause(); return; }",
        "",
        "    if (this.gamePaused || this.isInBuffer) { ev.preventDefault(); return; }",
        "",
        "    if (!this.leftGrid || !this.controller || !this.leftView) { return; }",
        "",
        "    ev.preventDefault();",
        "",
        "    this.controller.handleInput(ev); this.markMismatches();",
        "",
        "    this.leftView.update(this.leftGrid); this.gameView?.updateModeLabel();",
        "    const p = this.leftGrid.getCursor(); this.leftView.setCursor(p.row, p.col);",
        "};"
      ]
    }
  ]
}